<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil u≈æivatele - Bulldogo</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* Override styles to make profile content full width */
        .ad-detail-main {
            width: 100% !important;
            max-width: none !important;
        }
        
        .ad-detail-right {
            width: 100% !important;
            max-width: none !important;
        }
        
        .ad-title-section,
        .ad-meta-section,
        .ad-description-section,
        .ad-contact-section,
        .ad-actions {
            width: 100% !important;
            max-width: none !important;
        }
        
        .ad-detail-content {
            width: 100% !important;
            max-width: none !important;
        }
        
        /* Start Chat Button Styles */
        #startChatBtn {
            transition: all 0.3s ease;
            transform: scale(1);
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
            background-color: #ffd700 !important;
            color: white !important;
        }
        
        #startChatBtn i,
        #startChatBtn span {
            color: white !important;
        }

        #startChatBtn:hover {
            transform: scale(1.05) !important;
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
            background-color: #ffed4e !important;
            color: white !important;
        }
        
        #startChatBtn:hover i,
        #startChatBtn:hover span {
            color: white !important;
        }
        
        /* Back Button Styles */
        .back-btn {
            transition: all 0.3s ease;
            transform: scale(1);
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
            background: linear-gradient(135deg, #f77c00 0%, #fdf002 100%) !important;
            color: white !important;
            padding: 16px 24px !important;
            border-radius: 12px !important;
            font-size: 1rem !important;
            font-weight: 600 !important;
            gap: 8px !important;
        }
        
        .back-btn i,
        .back-btn span {
            color: white !important;
        }

        .back-btn:hover {
            transform: scale(1.05) !important;
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
            background: linear-gradient(135deg, #e66a00 0%, #fdf002 100%) !important;
            color: white !important;
        }
        
        .back-btn:hover i,
        .back-btn:hover span {
            color: white !important;
        }
        
        /* Ad Title Styles */
        .ad-title {
            font-size: 1.3rem !important;
            font-weight: 700 !important;
        }
        
        /* Category Icons Styles */
        .ad-category {
            background: #f88900 !important;
            color: white !important;
            padding: 0.2rem 0.6rem !important;
            border-radius: 12px !important;
            font-size: 0.8rem !important;
            font-weight: 500 !important;
        }
        
        /* Profile Chat Button Styles */
        .profile-chat-section {
            margin-top: 20px !important;
            padding: 15px 0 !important;
        }
        
        .profile-chat-btn {
            width: 100% !important;
            padding: 12px 20px !important;
            font-size: 1rem !important;
            font-weight: 600 !important;
            border-radius: 10px !important;
            background: linear-gradient(135deg, #f77c00 0%, #fdf002 100%) !important;
            color: white !important;
            border: none !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 8px !important;
        }
        
        .profile-chat-btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(247, 124, 0, 0.4) !important;
            background: linear-gradient(135deg, #e66a00 0%, #fdf002 100%) !important;
        }
        
        .profile-chat-btn:active {
            transform: translateY(0) !important;
            box-shadow: 0 2px 8px rgba(247, 124, 0, 0.3) !important;
        }
        
        .profile-chat-btn i {
            font-size: 1.1rem !important;
            color: white !important;
        }
    </style>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, initializeFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // Firebase konfigurace
        const firebaseConfig = {
            apiKey: "AIzaSyA1FEmsY458LLKQLGcUaOVXsYr3Ii55QeQ",
            authDomain: "inzerio-inzerce.firebaseapp.com",
            projectId: "inzerio-inzerce",
            storageBucket: "inzerio-inzerce.appspot.com",
            messagingSenderId: "262039290071",
            appId: "1:262039290071:web:30af0eb1c65cd75e307092",
            measurementId: "G-7VD0ZE08M3"
        };
        
        // Inicializace Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        let db;
        try {
            // Safari/localhost fix: vynutit long polling a vypnout fetch streams
            db = initializeFirestore(app, { experimentalForceLongPolling: true, useFetchStreams: false });
        } catch (e) {
            db = getFirestore(app);
        }
        
        // Export pro glob√°ln√≠ pou≈æit√≠
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
    </script>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <!-- Logo Section -->
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">B</div>
                <span class="logo-text">
                    <span class="logo-bull">ULL</span>
                    <span class="logo-dogo">DOGO</span>
                </span>
            </div>
            <div class="header-buttons">
            </div>
        </div>

        <!-- Navigation Section -->
        <div class="navigation-section">
            <h3 class="nav-section-title">NAVIGACE</h3>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <i class="fas fa-home nav-icon"></i>
                        <span class="nav-text">Dom≈Ø</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="services.html" class="nav-link">
                        <i class="fas fa-list-alt nav-icon"></i>
                        <span class="nav-text">Slu≈æby</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="my-ads.html" class="nav-link">
                        <i class="fas fa-user nav-icon"></i>
                        <span class="nav-text">M√© inzer√°ty</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="index.html#about" class="nav-link">
                        <i class="fas fa-info-circle nav-icon"></i>
                        <span class="nav-text">O n√°s</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="index.html#contact" class="nav-link">
                        <i class="fas fa-envelope nav-icon"></i>
                        <span class="nav-text">Kontakt</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="chat.html" class="nav-link">
                        <i class="fas fa-comment-alt nav-icon"></i>
                        <span class="nav-text">Chat</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="top-ads.html" class="nav-link">
                        <i class="fas fa-fire nav-icon"></i>
                        <span class="nav-text">Topov√°n√≠</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="packages.html" class="nav-link">
                        <i class="fas fa-box nav-icon"></i>
                        <span class="nav-text">Bal√≠ƒçky</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Auth Buttons Section (shown when not logged in) -->
        <div class="auth-section" id="authSection">
            <button class="btn-login" onclick="showAuthModal('login')">
                <i class="fas fa-sign-in-alt"></i>
                <span>P≈ôihl√°≈°en√≠</span>
            </button>
            <button class="btn-register" onclick="showAuthModal('register')">
                <i class="fas fa-user-plus"></i>
                <span>Registrace</span>
            </button>
        </div>

        <!-- User Profile Section (shown when logged in) -->
        <div class="user-profile-section" id="userProfileSection" style="display: none;">
            <button class="btn-profile" onclick="window.location.href='profile.html'">
                <i class="fas fa-user-circle"></i>
                <span>Profil</span>
            </button>
            <button class="btn-logout" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Odhl√°sit se</span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar Toggle Button (when collapsed) -->
    <button class="sidebar-toggle-btn" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content Wrapper -->
    <div class="main-content">
        <!-- Profile Detail Content -->
        <div class="ad-detail-content">
            <!-- Back Button -->
            <div class="ad-detail-header">
                <button class="back-btn" onclick="console.log('üîô Button clicked!'); goBack(); return false;" id="backButton">
                    <i class="fas fa-arrow-left"></i>
                    Zpƒõt
                </button>
            </div>

            <!-- Profile Information -->
            <div class="ad-detail-main" style="width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <!-- First Column - Basic Info -->
                <div class="ad-detail-right" style="width: 100%;">
                    <!-- Profile Title and Stats -->
                    <div class="ad-title-section" style="width: 100%;">
                        <h1 class="ad-detail-title" id="profileName">Jm√©no u≈æivatele</h1>
                        <div class="ad-detail-price" id="profileStats">Statistiky</div>
                    </div>

                    <!-- Profile Meta Information -->
                    <div class="ad-meta-section" style="width: 100%;">
                        <div class="ad-meta-item">
                            <i class="fas fa-envelope"></i>
                            <span id="profileEmail">Email</span>
                        </div>
                        <div class="ad-meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span id="profileLocation">Lokalita</span>
                        </div>
                        <div class="ad-meta-item">
                            <i class="fas fa-calendar"></i>
                            <span id="profileJoinDate">Registrov√°n</span>
                        </div>
                    </div>
                </div>

                <!-- Second Column - Additional Info -->
                <div class="ad-detail-right" style="width: 100%;">
                    <!-- Profile Description -->
                    <div class="ad-description-section" style="width: 100%;">
                        <h3>O u≈æivateli</h3>
                        <p class="ad-description" id="profileBio">Popis u≈æivatele</p>
                    </div>

                    <!-- Contact Information -->
                    <div class="ad-contact-section" style="width: 100%;">
                        <h3>Kontaktn√≠ informace</h3>
                        <div class="contact-info">
                            <div class="contact-item">
                                <i class="fas fa-user"></i>
                                <span id="profileDisplayName">Jm√©no u≈æivatele</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-envelope"></i>
                                <span id="profileDisplayEmail">Email</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-phone"></i>
                                <span id="profileDisplayPhone">Telefon</span>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Button in About User Section -->
                    <div class="profile-chat-section" style="width: 100%; margin-top: 20px;">
                        <button class="btn btn-primary profile-chat-btn" id="startChatBtn" onclick="console.log('üí¨ Chat button clicked!'); startChat(); return false;">
                            <i class="fas fa-comments"></i>
                            Zaƒç√≠t chat
                        </button>
                    </div>
                </div>
            </div>

            <!-- User Services Section -->
            <div class="ad-user-profile">
                <div class="user-other-ads" id="userOtherAds">
                    <h4>Slu≈æby od tohoto u≈æivatele</h4>
                    <div class="ads-grid" id="userServicesGrid">
                        <!-- User services will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- User Reviews Section -->
            <div class="ad-user-profile">
                <div class="user-profile-header">
                    <h4>Recenze u≈æivatele</h4>
                </div>
                <div class="user-other-ads" id="userReviewsSection">
                    <div class="ads-grid" id="userReviewsGrid">
                        <!-- User reviews will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Bulldogo.cz</h3>
                    <p>Profesion√°ln√≠ slu≈æby pro ka≈æd√©ho. Spojujeme z√°kazn√≠ky s kvalifikovan√Ωmi profesion√°ly.</p>
                </div>
                <div class="footer-section">
                    <h3>Rychl√© odkazy</h3>
                    <ul>
                        <li><a href="index.html">Dom≈Ø</a></li>
                        <li><a href="services.html">Slu≈æby</a></li>
                        <li><a href="index.html#about">O n√°s</a></li>
                        <li><a href="index.html#contact">Kontakt</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>D≈Øle≈æit√© odkazy</h3>
                    <ul>
                        <li><a href="#" onclick="return false;" style="cursor: default; text-decoration: none; color: inherit;">Cookies</a></li>
                        <li><a href="#" onclick="return false;" style="cursor: default; text-decoration: none; color: inherit;">GDPR</a></li>
                        <li><a href="soubory/podminky.pdf" target="_blank">VOP</a></li>
                    </ul>
                </div>
                <div class="footer-section" id="contact">
                    <h3>Kontakt</h3>
                    <p><i class="fas fa-phone"></i> +420 123 456 789</p>
                    <p><i class="fas fa-envelope"></i> support@bulldogo.cz</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Bulldogo.cz. V≈°echna pr√°va vyhrazena.</p>
            </div>
        </div>
    </footer>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">P≈ôihl√°≈°en√≠</h2>
                <span class="close" onclick="closeAuthModal()">&times;</span>
            </div>
            <form id="authForm" class="auth-form">
                <!-- V√Ωbƒõr typu registrace (pouze p≈ôi registraci) -->
                <div class="form-group registration-type" style="display: none;">
                    <label class="form-label">Typ registrace:</label>
                    <div class="registration-type-buttons">
                        <button type="button" class="registration-type-btn active" data-type="person">
                            <i class="fas fa-user"></i> Hobby (fyzick√° osoba)
                        </button>
                        <button type="button" class="registration-type-btn" data-type="company">
                            <i class="fas fa-building"></i> Firma
                        </button>
                    </div>
                </div>

                <!-- Formul√°≈ô pro fyzickou osobu -->
                <div class="person-form" style="display: none;">
                    <div class="form-group">
                        <input type="text" id="firstName" name="firstName" placeholder="Jm√©no" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="lastName" name="lastName" placeholder="P≈ô√≠jmen√≠" required>
                    </div>
                    <div class="form-group">
                        <input type="tel" id="phone" name="phone" placeholder="Telefon" required>
                    </div>
                    <div class="form-group">
                        <input type="date" id="birthDate" name="birthDate" placeholder="Datum narozen√≠" required>
                    </div>
                </div>

                <!-- Formul√°≈ô pro firmu -->
                <div class="company-form" style="display: none;">
                    <div class="form-group">
                        <input type="text" id="companyName" name="companyName" placeholder="N√°zev firmy" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="companyId" name="companyId" placeholder="IƒåO" required>
                    </div>
                    <div class="form-group">
                        <input type="tel" id="companyPhone" name="companyPhone" placeholder="Telefon" required>
                    </div>
                    <div class="form-group">
                        <input type="email" id="companyEmail" name="companyEmail" placeholder="Email" required>
                    </div>
                </div>

                <!-- Telefon a heslo -->
                <div class="form-group">
                    <input type="tel" id="authPhone" name="phone" placeholder="Telefon" required>
                </div>
                
                <div class="form-group" id="phoneStep2" style="display: none;">
                    <input type="text" id="phoneCode" name="phoneCode" placeholder="K√≥d z SMS" required>
                </div>
                
                <div class="form-group">
                    <input type="password" id="authPassword" name="password" placeholder="Heslo" required>
                </div>

                <div class="form-group">
                    <button type="submit" class="auth-submit-btn btn btn-primary">P≈ôihl√°sit se</button>
                    <button type="button" id="btnSendPhoneCode" class="btn btn-secondary" style="display: none;">Odeslat SMS k√≥d</button>
                    <button type="button" id="btnAuthSubmit" class="btn btn-primary" style="display: none;">Dokonƒçit registraci</button>
                </div>

                <div class="form-group">
                    <button type="button" class="auth-switch-btn btn btn-link">Nem√°te √∫ƒçet? Zaregistrujte se</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="auth.js"></script>
    <script src="profile-detail.js"></script>
    
    <!-- Test script for back button -->
    <script>
        // Simple test function
        function testBackButton() {
            console.log('üß™ Test back button clicked');
            alert('Tlaƒç√≠tko Zpƒõt funguje!');
        }
        
        // Make sure goBack function is available globally
        window.goBack = window.goBack || function() {
            console.log('üîô goBack called (fallback)');
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = 'services.html';
            }
        };
        
        // Make sure startChat function is available globally
        window.startChat = window.startChat || function() {
            console.log('üí¨ startChat called (fallback)');
            
            // Check if we're running on file:// protocol
            if (window.location.protocol === 'file:') {
                alert('Aplikace mus√≠ bƒõ≈æet na HTTP serveru pro spr√°vn√© fungov√°n√≠. Otev≈ôete http://localhost:8000');
                return;
            }
            
            alert('Funkce chatu nen√≠ dostupn√°. Zkuste se p≈ôihl√°sit.');
        };
        
        // Add click listener when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            const backBtn = document.getElementById('backButton');
            if (backBtn) {
                console.log('‚úÖ Back button found and ready');
                // Remove existing onclick and add new one
                backBtn.onclick = function() {
                    console.log('üîô Back button clicked (onclick)');
                    goBack();
                };
            } else {
                console.error('‚ùå Back button not found');
            }
            
            const chatBtn = document.getElementById('startChatBtn');
            if (chatBtn) {
                console.log('‚úÖ Chat button found and ready');
                // Add event listener for chat button
                chatBtn.addEventListener('click', function(e) {
                    console.log('üí¨ Chat button clicked (event listener)');
                    e.preventDefault();
                    startChat();
                });
            } else {
                console.error('‚ùå Chat button not found');
            }
        });
    </script>
</body>
</html>