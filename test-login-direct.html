<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test P≈ôihla≈°ov√°n√≠ - P≈ô√≠m√Ω</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; max-width: 600px; margin: 0 auto; }
        .form-group { margin: 1rem 0; }
        input { width: 100%; padding: 0.5rem; margin: 0.5rem 0; }
        button { padding: 1rem 2rem; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .result { margin: 1rem 0; padding: 1rem; background: #f8f9fa; border-radius: 5px; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
    </style>
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyA1FEmsY458LLKQLGcUaOVXsYr3Ii55QeQ",
            authDomain: "inzerio-inzerce.firebaseapp.com",
            projectId: "inzerio-inzerce",
            storageBucket: "inzerio-inzerce.firebasestorage.app",
            messagingSenderId: "262039290071",
            appId: "1:262039290071:web:30af0eb1c65cd75e307092",
            measurementId: "G-7VD0ZE08M3"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        
        console.log('üî• Firebase inicializov√°n pro p≈ô√≠m√Ω test');
        
        // Sledov√°n√≠ stavu p≈ôihl√°≈°en√≠
        import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js').then(({ onAuthStateChanged }) => {
            onAuthStateChanged(auth, (user) => {
                console.log('üë§ Auth state changed:', user ? `P≈ôihl√°≈°en: ${user.email}` : 'Odhl√°≈°en');
                updateUI(user);
            });
        });
    </script>
</head>
<body>
    <h1>Test P≈ôihla≈°ov√°n√≠ - P≈ô√≠m√Ω</h1>
    
    <div id="status" class="result">
        <h3>Stav syst√©mu:</h3>
        <div id="status-content">Naƒç√≠t√°m...</div>
    </div>
    
    <form id="loginForm">
        <h3>P≈ôihl√°≈°en√≠ (p≈ô√≠m√© vol√°n√≠ login funkce)</h3>
        <div class="form-group">
            <label>Email:</label><br>
            <input type="email" id="email" value="test@gmail.com" required>
        </div>
        <div class="form-group">
            <label>Heslo:</label><br>
            <input type="password" id="password" value="123123" required>
        </div>
        <button type="submit">P≈ôihl√°sit se (p≈ô√≠m√© vol√°n√≠)</button>
    </form>
    
    <button onclick="testDirectLogin()" style="background: #28a745; margin: 1rem 0;">
        Test P≈ô√≠m√© Vol√°n√≠ Login Funkce
    </button>
    
    <div id="results" class="result">
        <h3>V√Ωsledky:</h3>
        <div id="results-content">ƒåek√°m na akci...</div>
    </div>
    
    <div id="userInfo" class="result" style="display: none;">
        <h3>Informace o u≈æivateli:</h3>
        <div id="userInfo-content"></div>
        <button onclick="logout()">Odhl√°sit se</button>
    </div>
    
    <script src="script.js"></script>
    <script src="auth.js"></script>
    
    <script>
        function addResult(message, type = 'info') {
            const resultsContent = document.getElementById('results-content');
            const time = new Date().toLocaleTimeString();
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : '';
            
            resultsContent.innerHTML += `
                <div class="${className}" style="margin: 0.5rem 0; padding: 0.5rem; border-radius: 3px;">
                    <strong>${time}:</strong> ${message}
                </div>
            `;
        }
        
        function updateStatus() {
            const statusContent = document.getElementById('status-content');
            statusContent.innerHTML = `
                <p><strong>Firebase Auth:</strong> ${window.firebaseAuth ? '‚úÖ Naƒçten' : '‚ùå Nenalezen'}</p>
                <p><strong>Firebase DB:</strong> ${window.firebaseDb ? '‚úÖ Naƒçten' : '‚ùå Nenalezen'}</p>
                <p><strong>login funkce:</strong> ${typeof window.login}</p>
                <p><strong>Current User:</strong> ${window.firebaseAuth?.currentUser ? `P≈ôihl√°≈°en: ${window.firebaseAuth.currentUser.email}` : 'Odhl√°≈°en'}</p>
            `;
        }
        
        function updateUI(user) {
            const userInfo = document.getElementById('userInfo');
            const userInfoContent = document.getElementById('userInfo-content');
            
            if (user) {
                userInfo.style.display = 'block';
                userInfoContent.innerHTML = `
                    <p><strong>Email:</strong> ${user.email}</p>
                    <p><strong>UID:</strong> ${user.uid}</p>
                    <p><strong>Vytvo≈ôen:</strong> ${new Date(user.metadata.creationTime).toLocaleString()}</p>
                `;
                addResult(`‚úÖ P≈ôihl√°≈°en jako: ${user.email}`, 'success');
            } else {
                userInfo.style.display = 'none';
                addResult('üëã Odhl√°≈°en', 'info');
            }
        }
        
        async function testDirectLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            addResult(`üß™ Test p≈ô√≠m√©ho vol√°n√≠ login funkce: ${email}`, 'info');
            
            try {
                if (typeof window.login === 'function') {
                    console.log('üîê Vol√°m window.login p≈ô√≠mo');
                    await window.login(email, password);
                    addResult('‚úÖ Login funkce vol√°na √∫spƒõ≈°nƒõ', 'success');
                } else {
                    addResult('‚ùå Login funkce nen√≠ dostupn√°!', 'error');
                }
            } catch (error) {
                addResult(`‚ùå Chyba p≈ôi vol√°n√≠ login funkce: ${error.message}`, 'error');
                console.error('Chyba p≈ôi vol√°n√≠ login funkce:', error);
            }
        }
        
        async function logout() {
            try {
                if (!window.firebaseAuth) {
                    throw new Error('Firebase Auth nen√≠ dostupn√Ω');
                }
                
                const { signOut } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
                await signOut(window.firebaseAuth);
                addResult('‚úÖ Odhl√°≈°en√≠ √∫spƒõ≈°n√©', 'success');
            } catch (error) {
                addResult(`‚ùå Chyba p≈ôi odhla≈°ov√°n√≠: ${error.message}`, 'error');
                console.error('Chyba p≈ôi odhla≈°ov√°n√≠:', error);
            }
        }
        
        // Event listener pro formul√°≈ô
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            addResult(`üìù Formul√°≈ô odesl√°n: ${email}`, 'info');
            
            try {
                // Test p≈ô√≠m√©ho vol√°n√≠ login funkce
                if (typeof window.login === 'function') {
                    console.log('üîê Vol√°m window.login z formul√°≈ôe');
                    await window.login(email, password);
                } else {
                    addResult('‚ùå Login funkce nen√≠ dostupn√°!', 'error');
                }
            } catch (error) {
                addResult(`‚ùå Chyba: ${error.message}`, 'error');
                console.error('Chyba p≈ôi p≈ôihla≈°ov√°n√≠:', error);
            }
        });
        
        // Aktualizovat status ka≈ædou sekundu
        setInterval(updateStatus, 1000);
        
        // Inicializace
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üß™ Test login direct naƒçten');
            updateStatus();
            addResult('üìÑ Str√°nka naƒçtena', 'info');
        });
    </script>
</body>
</html>
